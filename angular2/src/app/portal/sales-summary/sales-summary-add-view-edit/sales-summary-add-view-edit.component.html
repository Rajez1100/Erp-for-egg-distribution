<!--View Design-->
<div *ngIf="mode == 'VIEW'" class="wrapper wrapper-content animated fadeInRight">
	<div class="row">
		<div class="col-md-12">
			<div class="ibox float-e-margins">
				<!--Title-->
				<div class="ibox-title">
					<h5>Sales Details</h5>
					<div class="ibox-tools">
						<div class="btn-group">
							<button type="button" (click)="initEditScreen()" class="btn btn-white btn-sm"><i class="fa fa-pen"></i> Edit details </button>
							<button type="button" (click)="back()" class="btn btn-white btn-sm"><i class="fa fa-pen"></i> Back </button>
						</div>
					</div>
				</div>
				<!--Content-->
				<div class="ibox-content">
					<div class="row">
						<!--Col - 1 - Sale details view-->
						<div class="col-md-6 padding-left-35 b-r">
							<!--Date-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Date</label>
								<label class="col-md-7 control-value colon-before">{{details.date}}</label>
							</div>
							<!--Sales Team-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Sales Team</label>
								<label class="col-md-7 control-value colon-before">{{details.sales_team_name}}</label>
							</div>
							<!--Damaged plates-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Damaged Plates</label>
								<label class="col-md-7 control-value colon-before">{{details.damaged_plates}}&ensp;plates.</label>
							</div>
							<!--Total Sold Plates-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Sold Plates</label>
								<label class="col-md-7 control-value colon-before">{{details.total_plates}}&ensp;plates.</label>
							</div>
							<!--Total Sale Cost-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Total Sale</label>
								<label class="col-md-7 control-value colon-before">{{details.total_cost | Currency:2:currencyFormat:true}}</label>
							</div>
							<!--Cash Handovered-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Cash Handovered</label>
								<label class="col-md-7 control-value colon-before">{{details.cash_handovered | Currency:2:currencyFormat:true}}</label>
							</div>
              	<!--Total Outstanding-->
							<div class="form-group row">
								<label class="col-md-4 control-label">Total Outstanding</label>
								<label class="col-md-7 control-value colon-before">{{details.total_outstanding | Currency:2:currencyFormat:true}}</label>
							</div>
						</div>

						<!--Col - 2 - sales rates details view-->
						<div class="col-md-6">
							<h4>Sale Rates</h4>
							<ul class="sale-rates-list">
								<li class="header">
									<span class="width-30">Rate</span>
									<span class="width-30">Plates</span>
									<span class="width-30">Cost</span>
								</li>
								<li *ngFor="let rate of details.rates; let i = index;">
									<span class="width-30">{{rate.rate |  Currency:2:currencyFormat:true}}</span>
									<span class="width-30">{{rate.no_of_plates}}</span>
									<span class="width-30">{{rate.rate * rate.no_of_plates |  Currency:2:currencyFormat:true}}</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!--Edit Design-->
<div *ngIf="mode == 'ADD' || mode == 'EDIT'" class="wrapper wrapper-content animated fadeInRight">
	<div class="row">
		<div class="col-lg-12">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>Provide Payment Details</h5>
				</div>
				<div class="ibox-content">
					<form *ngIf="form" [formGroup]="form" (ngSubmit)="save()" role="form">
						<div class="row">
							<!--Col - 1 - sales details form-->
							<div class="col-sm-6 b-r">
								<div class="form-group">
									<label>Date</label>
									<datetime id="datetimepicker1i" name="date" [timepicker]="false" [datepicker]="datepickerOptions" formControlName="date"></datetime>
									<control-messages [control]="form.controls.date"></control-messages>
								</div>
								<div class="form-group">
									<label>Sales Team</label>
									<ng-select allowClear="true" [items]="formData.sales_teams" [multiple]="false" (selected)="updateSalesTeam('changed', $event)"
										(removed)="updateSalesTeam('removed', $event)" [active]="selectedSalesTeam? [selectedSalesTeam]: []" placeholder="Select sales team">
									</ng-select>
									<control-messages [control]="form.controls.sales_team"></control-messages>
								</div>
								<div class="form-group">
									<label>Damaged Plates</label>
									<input type="number" formControlName="damaged_plates" placeholder="No of damaged plates" class="form-control">
									<control-messages [control]="form.controls.damaged_plates"></control-messages>
								</div>
								<div class="form-group">
									<label>Cash Handovered</label>
									<input type="text" formControlName="cash_handovered" appCurrencyFormatter [currency]="currencyFormat" placeholder="Submitted cash"
										class="form-control">
									<control-messages [control]="form.controls.cash_handovered"></control-messages>
								</div>
								<!--Total Sold Plates-->
								<div class="form-group row">
									<label class="col-md-4 control-label">Sold Plates</label>
									<label class="col-md-7 control-value colon-before">{{getTotalPlates()}}&ensp;plates.</label>
								</div>
								<!--Total Sale Cost-->
								<div class="form-group row">
									<label class="col-md-4 control-label">Total Sale</label>
									<label class="col-md-7 control-value colon-before">{{getTotalCost() | Currency:2:currencyFormat:true}}</label>
								</div>
                <!--Total Outstanding-->
								<div class="form-group row">
									<label class="col-md-4 control-label">Total Outstanding</label>
									<label class="col-md-7 control-value colon-before">{{ getTotalOutstanding() | Currency:2:currencyFormat:true}}</label>
								</div>
							</div>

							<!--Col - 2 - sales rates details form-->
							<div class="col-md-6">
								<h4>Sale Rates</h4>
								<ul formArrayName="rates" class="sale-rates-list">
									<li class="header">
										<span class="width-20">Rate</span>
										<span class="width-30">Plates</span>
                    <span class="width-30">Cost</span>
										<span class="width-10"><i (click)="addRate()" class="fa fa-plus btn btn-default btn-sm"></i></span>
									</li>
									<li [formGroupName]="i" *ngFor="let rateForm of form.controls['rates'].controls; let i = index;">
										<span class="width-20">
                      <input type="text" formControlName="rate" appCurrencyFormatter [currency]="currencyFormat" placeholder="Sale rate" class="form-control input-sm">
                    </span>
										<span class="width-30">
                      <input type="number" formControlName="no_of_plates" placeholder="Plates sold" class="form-control input-sm">
                    </span>
                    <span class="width-30">{{getCost(i) | Currency:2:currencyFormat:true}}</span>
										<span class="width-10"><i (click)="removeRate(i)" class="fa fa-times btn btn-default btn-sm"></i></span>
									</li>
								</ul>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-12 col-sm-12 text-right">
								<span [hidden]="state != 'FailedToSave'" class="text-danger">Failed to save. Please try again ... </span>

								<button type="button" [disabled]="state == 'saving'" (click)="cancel()" class="btn btn-sm btn-warning m-t-n-xs"><strong>Cancel</strong></button>

								<button type="submit" [disabled]="!form.valid || state == 'saving'" class="btn btn-sm btn-primary m-t-n-xs">
									<strong [hidden]="state == 'saving'">Save</strong>
									<strong [hidden]="state != 'saving'">Saving <i class="fa fa-spinner fa-spin"></i></strong>
								</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>